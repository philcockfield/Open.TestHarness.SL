// Open.TestHarness.js
(function(){function executeScript(){
Type.registerNamespace('Open.TestHarness');Open.TestHarness.CssSelectors=function(){}
Open.TestHarness.Elements=function(){}
Open.TestHarness.Application=function(){}
Open.TestHarness.Application.main=function(args){var $0=new Open.Core.Controls.LogView($(Open.TestHarness.CssSelectors.log).first());Open.Core.Log.registerView($0);Open.TestHarness.Application.$0=new Open.TestHarness.Controllers.PanelResizeController();Open.TestHarness.Application.$1=new Open.TestHarness.Controllers.SidebarController();var $1='/Content/Scripts/TestHarness.Script.Test.debug.js';var $2='TestHarness.Test.Application.main';var $3=Open.TestHarness.Models.TestPackageDef.singletonFromUrl($1,$2);Open.TestHarness.Application.$1.addPackage($3);}
Type.registerNamespace('Open.TestHarness.Models');Open.TestHarness.Models.TestClassListItem=function(testClass){Open.TestHarness.Models.TestClassListItem.initializeBase(this);this.$3_0=testClass;this.set_text(testClass.get_type().get_name());}
Open.TestHarness.Models.TestClassListItem.prototype={$3_0:null,get_testClass:function(){return this.$3_0;}}
Open.TestHarness.Models.TestPackageDef=function(scriptUrl,initMethod){this.$1=[];this.$2=new Open.TestHarness.Models.TestPackageLoader(this,scriptUrl.toLowerCase(),initMethod);}
Open.TestHarness.Models.TestPackageDef.get_singletons=function(){return Open.TestHarness.Models.TestPackageDef.$0;}
Open.TestHarness.Models.TestPackageDef.singletonFromUrl=function(scriptUrl,initMethod){var $0=Type.safeCast(Open.Core.Helper.get_collection().first(Open.TestHarness.Models.TestPackageDef.$0,function($p1_0){
return ($p1_0).get_id()===scriptUrl.toLowerCase();}),Open.TestHarness.Models.TestPackageDef);if($0==null){$0=new Open.TestHarness.Models.TestPackageDef(scriptUrl,initMethod);Open.TestHarness.Models.TestPackageDef.$0.add($0);}return $0;}
Open.TestHarness.Models.TestPackageDef.prototype={$2:null,get_id:function(){return this.get_loader().get_scriptUrl();},get_loader:function(){return this.$2;},get_isLoaded:function(){return this.get_loader().get_isLoaded();},get_count:function(){return this.$1.length;},getEnumerator:function(){return this.$1.getEnumerator();},addClass:function(testClass){if(testClass==null){return;}if(this.contains(testClass)){return;}this.$1.add(Open.TestHarness.Models.TestClassDef.getSingleton(testClass));},contains:function(testClass){return this.getTestClassDef(testClass)!=null;},getTestClassDef:function(testClass){if(testClass==null){return null;}var $0=testClass.get_fullName();var $enum1=ss.IEnumerator.getEnumerator(this.$1);while($enum1.moveNext()){var $1=$enum1.get_current();if($1.get_type().get_fullName()===$0){return $1;}}return null;}}
Open.TestHarness.Models.TestClassDef=function(type){this.$1=type;}
Open.TestHarness.Models.TestClassDef.getSingleton=function(testClass){if(Open.TestHarness.Models.TestClassDef.$0==null){Open.TestHarness.Models.TestClassDef.$0={};}var $0=testClass.get_fullName();if(Object.keyExists(Open.TestHarness.Models.TestClassDef.$0,$0)){return Type.safeCast(Open.TestHarness.Models.TestClassDef.$0[$0],Open.TestHarness.Models.TestClassDef);}var $1=new Open.TestHarness.Models.TestClassDef(testClass);Open.TestHarness.Models.TestClassDef.$0[$0]=$1;return $1;}
Open.TestHarness.Models.TestClassDef.prototype={$1:null,get_type:function(){return this.$1;}}
Open.TestHarness.Models.TestPackageListItem=function(testPackage){Open.TestHarness.Models.TestPackageListItem.initializeBase(this);this.$3_0=testPackage;this.set_text('FOO! TestPackage');}
Open.TestHarness.Models.TestPackageListItem.prototype={$3_0:null,get_testPackage:function(){return this.$3_0;}}
Open.TestHarness.Models.TestPackageLoader=function(parent,scriptUrl,initMethod){this.$0=parent;this.$1=scriptUrl;this.$2=initMethod;Open.Core.TestHarness.add_testClassRegistered(ss.Delegate.create(this,this.$6));}
Open.TestHarness.Models.TestPackageLoader.prototype={$0:null,$1:null,$2:null,$3:false,$4:null,$5:false,dispose:function(){Open.Core.TestHarness.remove_testClassRegistered(ss.Delegate.create(this,this.$6));},$6:function($p0,$p1){if(!this.$5){return;}this.$0.addClass($p1.testClass);},get_scriptUrl:function(){return this.$1;},get_initMethod:function(){return this.$2;},get_isLoaded:function(){return this.$3;},get_error:function(){return this.$4;},get_succeeded:function(){return this.get_error()==null;},load:function(onComplete){if(this.get_isLoaded()){Open.Core.Helper.invokeOrDefault(onComplete);return;}$.getScript(this.$1,ss.Delegate.create(this,function($p1_0){
try{this.$5=true;eval(this.$2+'();');}catch($1_0){Open.Core.Log.error(String.format('Failed to initialize the script-file at \'{0}\' with the entry method \'{1}()\'.<br/>Message: {2}',this.$1,this.$2,$1_0.message));this.$4=$1_0;}finally{this.$5=false;}this.$3=this.get_succeeded();Open.Core.Helper.invokeOrDefault(onComplete);}));}}
Type.registerNamespace('Open.TestHarness.Controllers');Open.TestHarness.Controllers.PanelResizeController=function(){Open.TestHarness.Controllers.PanelResizeController.initializeBase(this);this.$2_3=new Open.Core.UI.HorizontalPanelResizer(Open.TestHarness.CssSelectors.sidebar,'TH_SB');this.$2_3.add_resized(ss.Delegate.create(this,function(){
Open.TestHarness.Controllers.PanelResizeController.$2_6();}));this.$2_3.set_minWidth(200);this.$2_3.set_maxWidthMargin(80);Open.TestHarness.Controllers.PanelResizeController.$2_5(this.$2_3);Open.TestHarness.Controllers.PanelResizeController.$2_6();this.$2_4=new Open.Core.UI.VerticalPanelResizer(Open.Core.Css.toId('testHarnessLog'),'TH_OL');this.$2_4.add_resized(ss.Delegate.create(this,function(){
}));this.$2_4.set_minHeight($(Open.TestHarness.CssSelectors.logTitlebar).height());this.$2_4.set_maxHeightMargin(80);Open.TestHarness.Controllers.PanelResizeController.$2_5(this.$2_4);}
Open.TestHarness.Controllers.PanelResizeController.$2_5=function($p0){$p0.set_rootContainerId('testHarness');$p0.initialize();}
Open.TestHarness.Controllers.PanelResizeController.$2_6=function(){$(Open.TestHarness.CssSelectors.main).css(Open.Core.Css.left,$(Open.TestHarness.CssSelectors.sidebar).width()+1+Open.Core.Css.px);}
Open.TestHarness.Controllers.PanelResizeController.prototype={$2_3:null,$2_4:null}
Open.TestHarness.Controllers.SidebarController=function(){this.$2_2=[];Open.TestHarness.Controllers.SidebarController.initializeBase(this);this.$2_0=new Open.Core.Lists.ListTreeView($(Open.TestHarness.CssSelectors.sidebarList));this.$2_0.set_slideDuration(0.2);this.$2_1=new Open.Core.Lists.ListTreeBackController(this.$2_0,$(Open.TestHarness.CssSelectors.sidebarToolbar),$(Open.TestHarness.CssSelectors.backMask));this.$2_3();}
Open.TestHarness.Controllers.SidebarController.prototype={$2_0:null,$2_1:null,onDisposed:function(){this.$2_1.dispose();var $enum1=ss.IEnumerator.getEnumerator(this.$2_2);while($enum1.moveNext()){var $0=$enum1.get_current();$0.dispose();}Open.TestHarness.Controllers.SidebarController.callBaseMethod(this, 'onDisposed');},$2_3:function(){var $0=new Open.TestHarness.Controllers.MyNode('Root');$0.addChild(new Open.TestHarness.Controllers.MyNode('Recent'));$0.addChild(new Open.TestHarness.Controllers.MyNode('Child 2 (Can\'t Select)'));$0.addChild(new Open.TestHarness.Controllers.MyNode('Child 3'));var $1=Type.safeCast($0.childAt(0),Open.TestHarness.Controllers.MyNode);var $2=($0.childAt(1));var $3=($0.childAt(2));$1.addChild(new Open.TestHarness.Controllers.MyNode('Recent Child 1'));$1.addChild(new Open.TestHarness.Controllers.MyNode('Recent Child 2'));$1.addChild(new Open.TestHarness.Controllers.MyNode('Recent Child 3'));var $4=Type.safeCast($1.childAt(0),Open.TestHarness.Controllers.MyNode);$4.addChild(new Open.TestHarness.Controllers.MyNode('Recent Grandchild 1'));$4.addChild(new Open.TestHarness.Controllers.MyNode('Recent Grandchild 2'));$4.addChild(new Open.TestHarness.Controllers.MyNode('Recent Grandchild 3'));$2.addChild(new Open.TestHarness.Controllers.MyNode('Yo Child'));$3.addChild(new Open.TestHarness.Controllers.MyNode('Yo Child'));this.$2_0.set_rootNode($0);$1.set_text('My Recent Foo');$2.set_canSelect(false);$2.set_isSelected(true);},addPackage:function(testPackage){if(testPackage==null){return;}var $0=new Open.TestHarness.Models.TestPackageListItem(testPackage);this.$2_0.get_rootNode().addChild($0);var $1=new Open.TestHarness.Controllers.TestPackageController($0);this.$2_2.add($1);$1.add_loaded(ss.Delegate.create(this,function(){
this.$2_0.set_currentListRoot($1.get_rootNode());}));}}
Open.TestHarness.Controllers.MyNode=function(text){Open.TestHarness.Controllers.MyNode.initializeBase(this);this.set_text(text);}
Open.TestHarness.Controllers.MyNode.prototype={toString:function(){return Open.TestHarness.Controllers.MyNode.callBaseMethod(this, 'toString');}}
Open.TestHarness.Controllers.TestPackageController=function(rootNode){Open.TestHarness.Controllers.TestPackageController.initializeBase(this);this.$2_3=rootNode;rootNode.add_selectionChanged(ss.Delegate.create(this,this.$2_4));}
Open.TestHarness.Controllers.TestPackageController.prototype={add_loaded:function(value){this.$2_0=ss.Delegate.combine(this.$2_0,value);},remove_loaded:function(value){this.$2_0=ss.Delegate.remove(this.$2_0,value);},$2_0:null,$2_1:function(){if(this.$2_0!=null){this.$2_0.invoke(this,new ss.EventArgs());}},$2_3:null,$2_4:function($p0,$p1){if(this.get_rootNode().get_isSelected()){this.$2_5();}},get_testPackage:function(){return this.$2_3.get_testPackage();},get_rootNode:function(){return this.$2_3;},$2_5:function(){if(this.get_testPackage().get_isLoaded()){return;}var $0=this.get_testPackage().get_loader();var $1=Open.Core.Html.toHyperlink($0.get_scriptUrl(),null,0);var $2=new Open.Core.DelayedAction(5,ss.Delegate.create(this,function(){
Open.Core.Log.error(String.format('Failed to download the test-package at \'{0}\'.  Please ensure the file exists.',$1));Open.Core.Log.lineBreak();}));Open.Core.Log.info(String.format('Downloading test-package: {0} ...',$1));$0.load(ss.Delegate.create(this,function(){
$2.stop();if($0.get_succeeded()){Open.Core.Log.success('Test-package loaded successfully.');this.$2_6();this.$2_1();}Open.Core.Log.lineBreak();}));$2.start();},$2_6:function(){var $enum1=ss.IEnumerator.getEnumerator(this.get_testPackage());while($enum1.moveNext()){var $0=$enum1.get_current();var $1=new Open.TestHarness.Models.TestClassListItem($0);this.get_rootNode().addChild($1);}}}
Open.TestHarness.CssSelectors.registerClass('Open.TestHarness.CssSelectors');Open.TestHarness.Elements.registerClass('Open.TestHarness.Elements');Open.TestHarness.Application.registerClass('Open.TestHarness.Application');Open.TestHarness.Models.TestClassListItem.registerClass('Open.TestHarness.Models.TestClassListItem',Open.Core.Lists.ListItem);Open.TestHarness.Models.TestPackageDef.registerClass('Open.TestHarness.Models.TestPackageDef',null,ss.IEnumerable);Open.TestHarness.Models.TestClassDef.registerClass('Open.TestHarness.Models.TestClassDef');Open.TestHarness.Models.TestPackageListItem.registerClass('Open.TestHarness.Models.TestPackageListItem',Open.Core.Lists.ListItem);Open.TestHarness.Models.TestPackageLoader.registerClass('Open.TestHarness.Models.TestPackageLoader',null,ss.IDisposable);Open.TestHarness.Controllers.PanelResizeController.registerClass('Open.TestHarness.Controllers.PanelResizeController',Open.Core.ControllerBase);Open.TestHarness.Controllers.SidebarController.registerClass('Open.TestHarness.Controllers.SidebarController',Open.Core.ControllerBase);Open.TestHarness.Controllers.MyNode.registerClass('Open.TestHarness.Controllers.MyNode',Open.Core.Lists.ListItem);Open.TestHarness.Controllers.TestPackageController.registerClass('Open.TestHarness.Controllers.TestPackageController',Open.Core.ControllerBase);Open.TestHarness.CssSelectors.sidebar='#testHarnessSidebar';Open.TestHarness.CssSelectors.sidebarList='#testHarnessSidebar .th-sidebarList';Open.TestHarness.CssSelectors.sidebarToolbar='#testHarnessSidebar div.th-toolbar';Open.TestHarness.CssSelectors.backMask='#testHarnessSidebar img.th-backMask';Open.TestHarness.CssSelectors.main='#testHarness .th-main';Open.TestHarness.CssSelectors.logTitlebar='#testHarnessLog .th-log-titlebar';Open.TestHarness.CssSelectors.log='#testHarnessLog .coreLog';Open.TestHarness.Elements.root='testHarness';Open.TestHarness.Elements.outputLog='testHarnessLog';Open.TestHarness.Application.$0=null;Open.TestHarness.Application.$1=null;Open.TestHarness.Models.TestPackageDef.$0=[];Open.TestHarness.Models.TestClassDef.$0=null;
// ---- Do not remove this footer ----
// This script was generated using Script# v0.6.0.0 (http://projects.nikhilk.net/ScriptSharp)
// -----------------------------------
}
ss.loader.registerScript('TestHarness.Script3',['Open.Core.Views','Open.Core.Script','Open.Core.Lists'],executeScript);})();